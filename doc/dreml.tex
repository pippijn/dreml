\documentclass[10pt,a4paper,german,headsepline,twoside,DIV15,BCOR12mm]{scrbook}
\usepackage{framed}
\usepackage[utf8x]{inputenc}
\usepackage{enumerate}
\usepackage{enumitem}
\usepackage{needspace}
\usepackage[implicit,naturalnames]{hyperref}
\usepackage{noweb}
\usepackage{graphviz}
\usepackage{color}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage[margin=2cm]{geometry}
\usepackage{tikz}

% Colours
\newcommand{\optcolor}[2]{\textcolor[rgb]{#1}{#2}}

% Images
\newcommand{\img}[2]{\includegraphics[width=#2]{#1.pdf}}

% Theorems
\theoremstyle{definition}

\newtheorem{thm2}{\optcolor{1,0,0}{Theorem}}
\newtheorem{lem2}[thm2]{\optcolor{1,0,0}{Lemma}}
\newtheorem{defn2}[thm2]{\optcolor{0,0,1}{Definition}}
\newtheorem{eg2}{\optcolor{0,0.5,0}{Example}}
\newtheorem{rem2}[eg2]{Remark}

\newlength{\topsepbackup}

\newcommand{\newboxenv}[4]
  {\newenvironment{#1}
    {
      \pagebreak[2]
      \ifx\bw\relax
        \definecolor{shadecolor}{gray}{#3}
      \else
        \definecolor{shadecolor}{rgb}{#4}
      \fi
      \setlength{\topsepbackup}{\topsep}
      \setlength{\topsep}{0pt}
      \begin{shaded}
      \begin{#2}
    }{
      \end{#2}
      \end{shaded}
      \setlength{\topsep}{\topsepbackup}
    }
  }

\newboxenv{thm}{thm2}{0.9}{0.95,0.95,0.95}
\newboxenv{lem}{lem2}{0.9}{0.95,0.95,0.95}
\newboxenv{defn}{defn2}{0.91}{0.95,0.95,0.95}
\newboxenv{eg}{eg2}{0.91}{0.95,0.95,0.95}
\newboxenv{rem}{rem2}{0.91}{0.95,0.95,0.95}

\noweboptions{smallcode}

\sloppy
\frenchspacing
\parskip=3pt
\parindent=0pt

\begin{document}

\input{tex/macros}

\input{tex/intro}
\input{tex/background}
\input{tex/submatching}
\input{tex/implementation}
\input{tex/results}
\input{tex/discussion}
\input{tex/conclusion}

\nowebchunks

\bibliographystyle{alpha}
\bibliography{dreml}

\end{document}
